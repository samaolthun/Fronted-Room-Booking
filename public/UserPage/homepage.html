
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Booking System</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link rel="stylesheet" href="homepage.css">
    
</head>
<body>
     <div class="header">
        <div class="logo">
          <img src="https://upload.wikimedia.org/wikipedia/km/e/ee/Rupp_logo.png?20090803154844" alt="RUPP Logo">
          <div>Royal University of Phnom Penh</div>
        </div>

        <div class="nav">
          <a href="homepage.html" class="nav-item active">Home</a>
          <a href="history.html" class="nav-item">History</a>
          <a href="setting.html" class="nav-item">Setting</a>
          <a href="about-us.html" class="nav-item">About us</a>
          <a href="service.html" class="nav-item">Service</a>
        </div>
    </div>

    <div class="map-container">
        <div class="card-map">
            <img src="https://scontent.fpnh2-1.fna.fbcdn.net/v/t1.6435-9/45685104_1734483090012227_7494844332407521280_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=833d8c&_nc_eui2=AeFSfGIZ4HFfbZ6yqjf2bByjoLlABriwuUmguUAGuLC5SYHWcuvPIOsm4arN2dfPN-n06CAracd4aU1ZbrQ0rQoc&_nc_ohc=IGYwZkXEWtwQ7kNvwFcD5sI&_nc_oc=AdkZXsfpKkqkL2QgebEbwJPE2V8V1m2zaJZ5YXgj17Z7cXb_YkS8L5EA7WOkwEufOU0&_nc_zt=23&_nc_ht=scontent.fpnh2-1.fna&_nc_gid=WE7J-HRlhzIQdqSlRbmZ7A&oh=00_AfIOvIQLRqnCnM8SQxTw21gkK6Z4gKwja1ivPwHZfGJ7kQ&oe=68670724" alt="">
        </div>

        <!-- <div class="card-map">
            <div class="banner">
                <div class="image"></div>
            </div>
        </div> -->

    </div>
    

   <div class="container">

        <div class="card">
            <div class="section">
                <div class="section-title">Building</div>
                <div class="dropdown-container">
                    <!-- <div class="dropdown tooltip">
                        <i class="fas fa-building-user"></i> Building A
                        <span class="dropdown-arrow"></span>
                        <span class="tooltiptext">Select the building you want to book a room in</span>
                    </div> -->
                    <select id="buildingSelect" class="form-control">
                        <option disabled selected>Select Building</option>
                        <option>Building A</option>
                        <option>Building B</option>
                        <option>Building C</option>
                        <option>Building T</option>
                        <option>Building STEM</option>

                    </select>

                </div>
            </div>
            
            <div class="section">
                <div class="section-title">Room</div>
                <div class="dropdown-container">
                    <!-- <div class="dropdown tooltip">

                        <i class="fas fa-door-open"></i> Room 206
                        <span class="dropdown-arrow"></span>
                        <span class="tooltiptext">Select the specific room number</span>
                    </div> -->
                    <select id="roomSelect" class="form-control">
                        <option disabled selected>Select Room</option>
                        <option>Room 101</option>
                        <option>Room 204</option>
                        <option>Room 304</option>
                        <option>Room 301</option>
                        <option>Room 306</option>
                    </select>

                </div>
            </div>
            
            <div class="section">
                <div class="section-title">View Room</div>
                <div class="view-container">
                    <div class="room-info">
                        <i class="fas fa-map-location-dot"></i>
                        <span>Building A, Room 206</span>
                    </div>
                    <div class="status-container">
                        <span class="status available">Available</span>
                        <span class="status unavailable">Unavailable</span>
                        <span class="dropdown-arrow"></span>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="date-selector">
                <div class="section-title">Date</div>
                <!-- <button class="date-btn">27th</button>
                <button class="date-btn">June</button>
                <button class="date-btn">2023</button> -->
                <input type="date" id="dateInput" class="form-control">
            </div>
            
            <div class="date-selector">
                <div class="section-title">Time</div>
            </div>
            
            <div class="time-container">
                <!-- <div class="time-label">From</div>
                <div class="time-input" id="startTime">8:00</div>
                <div class="time-period">AM <i class="fas fa-caret-down"></i></div> -->
                <input type="time" id="startTime" class="form-control">
                <input type="time" id="endTime" class="form-control">



            </div>
            
            <!-- <div class="time-container">
                <div class="time-label">To</div>
                <div class="time-input" id="endTime">10:00</div>
                <div class="time-period">AM <i class="fas fa-caret-down"></i></div>
            </div> -->
            
            <div class="form-group">
                <div class="section-title">Purpose</div>
                <select class="form-control">
                    <option selected disabled>Select booking purpose</option>
                    <option>Lecture</option>
                    <option>Meeting</option>
                    <option>Workshop</option>
                    <option>Conference</option>
                    <option>Other</option>
                </select>
            </div>
            
            <div class="form-group">
                <div class="section-title">Number of Attendees</div>
                <input type="number" class="form-control" placeholder="Enter expected number of attendees" min="1">
            </div>
            
            <button class="booking-btn" id="bookingBtn">
                <i class="fas fa-calendar-check"></i> Book Now
            </button>
        </div>
    </div>
    
    <!-- <div class="user-icon tooltip">
        <i class="fas fa-user"></i>
        <span class="tooltiptext">User Profile</span>
    </div> -->
    
    <!-- Confirmation Modal -->
    <div id="bookingModal" class="modal">
        <div class="modal-content">
            <div class="modal-icon">
                <i class="fas fa-calendar-check"></i>
            </div>
            <div class="modal-header">
                <h3>Confirm Booking</h3>
                <p>Please review the details of your booking</p>
            </div>
            
            <div class="modal-details">
                <div class="detail-item">
                    <span class="detail-label">Building:</span>
                    <span class="detail-value">Building A</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Room:</span>
                    <span class="detail-value">Room 206</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Date:</span>
                    <span class="detail-value">27th June, 2023</span>
                </div>
                <div class="detail-item">
                    <span class="detail-label">Time:</span>
                    <span class="detail-value">8:00 AM - 10:00 AM</span>
                </div>
            </div>
            
            <div class="modal-buttons">
                <button class="modal-btn confirm-btn">Confirm</button>
                <button class="modal-btn cancel-btn" id="cancelBtn">Cancel</button>
            </div>
        </div>
    </div>
    
    <script>
document.addEventListener('DOMContentLoaded', function () {
    const buildingSelect = document.getElementById('buildingSelect');
    const roomSelect = document.getElementById('roomSelect');
    const dateInput = document.getElementById('dateInput');
    const startTimeInput = document.getElementById('startTime');
    const endTimeInput = document.getElementById('endTime');
    const bookingBtn = document.getElementById('bookingBtn');
    const bookingModal = document.getElementById('bookingModal');
    const cancelBtn = document.getElementById('cancelBtn');
    const confirmBtn = document.querySelector('.confirm-btn');

    // Open modal on "Book Now"
    bookingBtn.addEventListener('click', () => {
        bookingModal.style.display = 'block';

        // Update modal display values
        const modalDetails = document.querySelectorAll('.modal-details .detail-item');
        modalDetails[0].querySelector('.detail-value').innerText = buildingSelect.value;
        modalDetails[1].querySelector('.detail-value').innerText = roomSelect.value;
        modalDetails[2].querySelector('.detail-value').innerText = dateInput.value;
        modalDetails[3].querySelector('.detail-value').innerText = `${startTimeInput.value} - ${endTimeInput.value}`;
    });

    // Close modal
    cancelBtn.addEventListener('click', () => {
        bookingModal.style.display = 'none';
    });

    // Close modal by clicking outside
    window.addEventListener('click', event => {
        if (event.target === bookingModal) {
            bookingModal.style.display = 'none';
        }
    });

    // Confirm Booking -> Send data to backend
    confirmBtn.addEventListener('click', async () => {
        const bookingData = {
            building: buildingSelect.value,
            room: roomSelect.value,
            date: dateInput.value,
            startTime: startTimeInput.value,
            endTime: endTimeInput.value
        };

        try {
            const response = await fetch('http://localhost:5000/api/book', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(bookingData)
            });

            if (response.status === 201) {
                alert("‚úÖ Booking Confirmed!");
            } else if (response.status === 409) {
                alert("‚ùå Time slot already booked!");
            } else {
                alert("‚ö†Ô∏è Something went wrong.");
            }
        } catch (error) {
            alert("üö´ Cannot connect to server.");
            console.error(error);
        }

        bookingModal.style.display = 'none';
    });
});
</script>


</body>
</html>